
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Allow public read on certificates for verification
    // Allow anyone to create/delete for now to fix creation bug.
    // TODO: Implement more secure, role-based write rules.
    match /certificates/{document=**} {
      allow read, write: if true;
    }

    // Rules for user management
    match /users/{userId} {
      // Allow anyone to create a user (register)
      allow create: if true;
      
      // Only the authenticated user can read their own data.
      // This rule is not currently effective because we don't use Firebase Auth.
      allow read, update, delete: if request.auth != null && request.auth.uid == userId;
    }
  }
}
